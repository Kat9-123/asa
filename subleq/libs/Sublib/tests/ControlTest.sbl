!J .main
#sublib
#sublib/Control

THREE -> 3

TWO -> 2
a -> 'Y'
LINEBREAK -> '\n'

i -> 0
p -> 0
@Mac m_copy? {
    !=0 p 

    !While (!Neq p TWO) {
        m_copy? i

        !While (!Ge i ZERO) { ;::Ge i ZERO {
            !If (!Neq SNEG ONE) {
                !IO -= a
            }
            !Dec i
        }
        !IO -= LINEBREAK
        !Inc p
    }
}
.err ->
    !IO::PrintLnLit "FAILED"
    !Halt

@TestIf m_true_conditional? L_A? L_B? {
    != a L_A?
    != b L_B?

    !If (m_true_conditional? a b) {

        !J .fin
    }
    !J .err

    .fin ->


}

.main -> {
    !If (!Eq SNEG SNEG) {

        !Mac (!CopyLit 3)   ; 'curried' macro
    }
    !IO -= LINEBREAK
    !If (!Ge ZERO SNEG) {

        !Mac (!CopyLit 2)   ; 'curried' macro
    }

    ;!TestIf (!Eq) 10 10
    ;!TestIf (!Neq) 0 -1
    ;!TestIf (!Geq) 20 10
    ;!TestIf (!Leq) -10 -9
    ;!TestIf (!Ge) 0 0x8000
    ;!TestIf (!Le) 0 10
    !Halt
}